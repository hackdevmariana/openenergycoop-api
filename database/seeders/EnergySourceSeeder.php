<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\EnergySource;
use App\Models\User;
use Carbon\Carbon;

class EnergySourceSeeder extends Seeder
{
    public function run(): void
    {
        $users = User::take(3)->get();
        if ($users->isEmpty()) {
            $this->command->warn('âš ï¸ No hay usuarios disponibles. Saltando EnergySourceSeeder.');
            return;
        }

        $sources = [
            [
                'name' => 'Parque Solar Fotovoltaico "Sol de AndalucÃ­a"',
                'description' => 'Granja solar fotovoltaica de gran escala ubicada en AndalucÃ­a con tecnologÃ­a de Ãºltima generaciÃ³n.',
                'source_type' => EnergySource::SOURCE_TYPE_SOLAR,
                'status' => EnergySource::STATUS_ACTIVE,
                'energy_category' => EnergySource::ENERGY_CATEGORY_RENEWABLE,
                'installed_capacity_mw' => 100.00,
                'operational_capacity_mw' => 95.50,
                'efficiency_rating' => 22.5,
                'availability_factor' => 98.2,
                'capacity_factor' => 25.8,
                'annual_production_mwh' => 220000.00,
                'monthly_production_mwh' => 18333.33,
                'daily_production_mwh' => 602.74,
                'hourly_production_mwh' => 25.11,
                'location_address' => 'Finca Solar AndalucÃ­a, Sevilla',
                'latitude' => 37.3891,
                'longitude' => -5.9845,
                'region' => 'AndalucÃ­a',
                'country' => 'EspaÃ±a',
                'commissioning_date' => Carbon::now()->subYears(3),
                'expected_lifespan_years' => 25,
                'construction_cost' => 80000000.00,
                'operational_cost_per_mwh' => 15.50,
                'maintenance_cost_per_mwh' => 8.25,
                'technical_specifications' => 'Paneles monocristalinos de 550W, inversores string de 1MW',
                'environmental_impact' => 'ReducciÃ³n de 110,000 toneladas de CO2 anuales',
                'regulatory_compliance' => 'Cumple normativa RD 244/2019 y directivas europeas',
                'safety_features' => 'Sistema de desconexiÃ³n automÃ¡tica, vallado perimetral',
                'equipment_details' => '15,000 paneles solares, 100 inversores, sistema de seguimiento',
                'maintenance_schedule' => 'InspecciÃ³n mensual, limpieza trimestral, revisiÃ³n anual',
                'performance_metrics' => ['Factor de capacidad', 'Disponibilidad', 'Eficiencia energÃ©tica'],
                'environmental_data' => ['Emisiones evitadas', 'Huella de carbono', 'Impacto ambiental'],
                'regulatory_documents' => ['Permisos ambientales', 'Licencias de explotaciÃ³n', 'Certificados de origen'],
                'tags' => ['solar', 'fotovoltaica', 'andaluciÌa', 'renovable'],
                'managed_by' => $users->first()->id,
                'created_by' => $users->first()->id,
                'approved_by' => $users->first()->id,
                'approved_at' => Carbon::now()->subYears(2),
                'notes' => 'Fuente de energÃ­a solar de referencia en AndalucÃ­a',
            ],
            [
                'name' => 'Parque EÃ³lico "Vientos del Norte"',
                'description' => 'Parque eÃ³lico terrestre con turbinas de Ãºltima generaciÃ³n en la costa norte.',
                'source_type' => EnergySource::SOURCE_TYPE_WIND,
                'status' => EnergySource::STATUS_ACTIVE,
                'energy_category' => EnergySource::ENERGY_CATEGORY_RENEWABLE,
                'installed_capacity_mw' => 80.00,
                'operational_capacity_mw' => 78.50,
                'efficiency_rating' => 45.2,
                'availability_factor' => 95.8,
                'capacity_factor' => 42.5,
                'annual_production_mwh' => 298000.00,
                'monthly_production_mwh' => 24833.33,
                'daily_production_mwh' => 816.44,
                'hourly_production_mwh' => 34.02,
                'location_address' => 'Costa del Norte, Cantabria',
                'latitude' => 43.4623,
                'longitude' => -3.8099,
                'region' => 'Cantabria',
                'country' => 'EspaÃ±a',
                'commissioning_date' => Carbon::now()->subYears(2),
                'expected_lifespan_years' => 20,
                'construction_cost' => 120000000.00,
                'operational_cost_per_mwh' => 18.75,
                'maintenance_cost_per_mwh' => 12.50,
                'technical_specifications' => 'Turbinas de 4MW, altura de buje 120m, diÃ¡metro de rotor 150m',
                'environmental_impact' => 'ReducciÃ³n de 149,000 toneladas de CO2 anuales',
                'regulatory_compliance' => 'Cumple normativa eÃ³lica nacional y europea',
                'safety_features' => 'Sistema de parada automÃ¡tica, seÃ±alizaciÃ³n aeronÃ¡utica',
                'equipment_details' => '20 turbinas eÃ³licas, subestaciÃ³n elÃ©ctrica, sistema SCADA',
                'maintenance_schedule' => 'InspecciÃ³n trimestral, mantenimiento anual, revisiÃ³n de 5 aÃ±os',
                'performance_metrics' => ['Factor de capacidad', 'Disponibilidad tÃ©cnica', 'ProducciÃ³n anual'],
                'environmental_data' => ['Emisiones evitadas', 'Impacto en avifauna', 'Ruido ambiental'],
                'regulatory_documents' => ['Permisos ambientales', 'Licencias de explotaciÃ³n', 'Estudios de impacto'],
                'tags' => ['eolica', 'cantabria', 'renovable', 'costa'],
                'managed_by' => $users->skip(1)->first()->id,
                'created_by' => $users->first()->id,
                'approved_by' => $users->first()->id,
                'approved_at' => Carbon::now()->subMonths(18),
                'notes' => 'Parque eÃ³lico de alta eficiencia en zona de vientos constantes',
            ],
            [
                'name' => 'Central HidroelÃ©ctrica "RÃ­o Verde"',
                'description' => 'Central hidroelÃ©ctrica de embalse con turbinas Francis de alta eficiencia.',
                'source_type' => EnergySource::SOURCE_TYPE_HYDROELECTRIC,
                'status' => EnergySource::STATUS_ACTIVE,
                'energy_category' => EnergySource::ENERGY_CATEGORY_RENEWABLE,
                'installed_capacity_mw' => 50.00,
                'operational_capacity_mw' => 48.75,
                'efficiency_rating' => 92.8,
                'availability_factor' => 98.5,
                'capacity_factor' => 65.2,
                'annual_production_mwh' => 285000.00,
                'monthly_production_mwh' => 23750.00,
                'daily_production_mwh' => 780.82,
                'hourly_production_mwh' => 32.53,
                'location_address' => 'Embalse RÃ­o Verde, Sierra Nevada, Granada',
                'latitude' => 37.0000,
                'longitude' => -3.5000,
                'region' => 'AndalucÃ­a',
                'country' => 'EspaÃ±a',
                'commissioning_date' => Carbon::now()->subYears(8),
                'expected_lifespan_years' => 50,
                'construction_cost' => 150000000.00,
                'operational_cost_per_mwh' => 12.25,
                'maintenance_cost_per_mwh' => 6.75,
                'technical_specifications' => 'Turbinas Francis de 25MW, embalse de regulaciÃ³n',
                'environmental_impact' => 'ReducciÃ³n de 142,500 toneladas de CO2 anuales',
                'regulatory_compliance' => 'Cumple normativa hidroelÃ©ctrica y ambiental',
                'safety_features' => 'Sistema de alivio de presiÃ³n, monitoreo sÃ­smico',
                'equipment_details' => '2 turbinas Francis, generadores sÃ­ncronos, sistema de control',
                'maintenance_schedule' => 'InspecciÃ³n mensual, mantenimiento semestral, revisiÃ³n anual',
                'performance_metrics' => ['Factor de capacidad', 'Disponibilidad', 'Eficiencia hidrÃ¡ulica'],
                'environmental_data' => ['Impacto en ecosistemas acuÃ¡ticos', 'GestiÃ³n de caudales'],
                'regulatory_documents' => ['ConcesiÃ³n hidroelÃ©ctrica', 'Permisos ambientales', 'Plan de gestiÃ³n'],
                'tags' => ['hidroelectrica', 'granada', 'renovable', 'embalse'],
                'managed_by' => $users->skip(2)->first()->id,
                'created_by' => $users->first()->id,
                'approved_by' => $users->first()->id,
                'approved_at' => Carbon::now()->subYears(7),
                'notes' => 'Central hidroelÃ©ctrica de referencia con alta disponibilidad',
            ],
            [
                'name' => 'Planta de Biomasa "EnergÃ­a Verde"',
                'description' => 'Planta de generaciÃ³n elÃ©ctrica mediante combustiÃ³n de biomasa forestal.',
                'source_type' => EnergySource::SOURCE_TYPE_BIOMASS,
                'status' => EnergySource::STATUS_ACTIVE,
                'energy_category' => EnergySource::ENERGY_CATEGORY_RENEWABLE,
                'installed_capacity_mw' => 25.00,
                'operational_capacity_mw' => 24.00,
                'efficiency_rating' => 35.5,
                'availability_factor' => 92.0,
                'capacity_factor' => 85.5,
                'annual_production_mwh' => 187000.00,
                'monthly_production_mwh' => 15583.33,
                'daily_production_mwh' => 512.33,
                'hourly_production_mwh' => 21.35,
                'location_address' => 'PolÃ­gono Industrial, LeÃ³n',
                'latitude' => 42.5987,
                'longitude' => -5.5673,
                'region' => 'Castilla y LeÃ³n',
                'country' => 'EspaÃ±a',
                'commissioning_date' => Carbon::now()->subYears(4),
                'expected_lifespan_years' => 25,
                'construction_cost' => 60000000.00,
                'operational_cost_per_mwh' => 45.50,
                'maintenance_cost_per_mwh' => 18.75,
                'technical_specifications' => 'Caldera de lecho fluidizado, turbina de vapor, sistema de tratamiento de gases',
                'environmental_impact' => 'ReducciÃ³n de 93,500 toneladas de CO2 anuales',
                'regulatory_compliance' => 'Cumple normativa de emisiones y biomasa',
                'safety_features' => 'Sistema de extinciÃ³n automÃ¡tica, monitoreo de emisiones',
                'equipment_details' => 'Caldera de biomasa, turbina de vapor, sistema de tratamiento',
                'maintenance_schedule' => 'InspecciÃ³n semanal, mantenimiento mensual, parada anual',
                'performance_metrics' => ['Factor de capacidad', 'Eficiencia de combustiÃ³n', 'Emisiones'],
                'environmental_data' => ['Emisiones de CO2', 'GestiÃ³n de cenizas', 'Consumo de biomasa'],
                'regulatory_documents' => ['Permisos ambientales', 'Licencias de explotaciÃ³n', 'Certificados de biomasa'],
                'tags' => ['biomasa', 'leon', 'renovable', 'forestal'],
                'managed_by' => $users->first()->id,
                'created_by' => $users->first()->id,
                'approved_by' => $users->first()->id,
                'approved_at' => Carbon::now()->subYears(3),
                'notes' => 'Planta de biomasa con gestiÃ³n sostenible de recursos forestales',
            ],
            [
                'name' => 'Central de Ciclo Combinado "Gas Natural"',
                'description' => 'Central tÃ©rmica de ciclo combinado con turbinas de gas y vapor.',
                'source_type' => EnergySource::SOURCE_TYPE_FOSSIL_FUEL,
                'status' => EnergySource::STATUS_ACTIVE,
                'energy_category' => EnergySource::ENERGY_CATEGORY_NON_RENEWABLE,
                'installed_capacity_mw' => 400.00,
                'operational_capacity_mw' => 380.00,
                'efficiency_rating' => 58.5,
                'availability_factor' => 88.5,
                'capacity_factor' => 45.2,
                'annual_production_mwh' => 1584000.00,
                'monthly_production_mwh' => 132000.00,
                'daily_production_mwh' => 4339.73,
                'hourly_production_mwh' => 180.82,
                'location_address' => 'PolÃ­gono Industrial, Tarragona',
                'latitude' => 41.1189,
                'longitude' => 1.2445,
                'region' => 'CataluÃ±a',
                'country' => 'EspaÃ±a',
                'commissioning_date' => Carbon::now()->subYears(6),
                'expected_lifespan_years' => 30,
                'construction_cost' => 400000000.00,
                'operational_cost_per_mwh' => 65.25,
                'maintenance_cost_per_mwh' => 25.50,
                'technical_specifications' => 'Turbinas de gas de 200MW, turbina de vapor de 200MW',
                'environmental_impact' => 'Emisiones controladas de CO2, NOx y SOx',
                'regulatory_compliance' => 'Cumple normativa de emisiones industriales',
                'safety_features' => 'Sistema de detecciÃ³n de fugas, extinciÃ³n automÃ¡tica',
                'equipment_details' => '2 turbinas de gas, 1 turbina de vapor, generadores',
                'maintenance_schedule' => 'InspecciÃ³n diaria, mantenimiento mensual, parada anual',
                'performance_metrics' => ['Factor de capacidad', 'Eficiencia tÃ©rmica', 'Emisiones'],
                'environmental_data' => ['Emisiones de CO2', 'Consumo de gas natural', 'Eficiencia energÃ©tica'],
                'regulatory_documents' => ['Permisos ambientales', 'Licencias de explotaciÃ³n', 'Certificados de emisiones'],
                'tags' => ['gas', 'tarragona', 'ciclo-combinado', 'termica'],
                'managed_by' => $users->skip(1)->first()->id,
                'created_by' => $users->first()->id,
                'approved_by' => $users->first()->id,
                'approved_at' => Carbon::now()->subYears(5),
                'notes' => 'Central de ciclo combinado de alta eficiencia para respaldo del sistema',
            ],
        ];

        foreach ($sources as $source) {
            EnergySource::firstOrCreate(
                ['name' => $source['name']],
                $source
            );
        }

        $this->command->info('âœ… EnergySourceSeeder ejecutado correctamente');
        $this->command->info('ğŸ“Š Fuentes de energÃ­a creadas: ' . count($sources));
        $this->command->info('ğŸ¯ Tipos: Solar PV, EÃ³lica Onshore, HidroelÃ©ctrica, Biomasa, Gas Natural');
        $this->command->info('ğŸ“ˆ Estados: Todas activas');
        $this->command->info('âš¡ Capacidad total instalada: ' . number_format(collect($sources)->sum('installed_capacity_mw'), 2) . ' MW');
        $this->command->info('ğŸ’° InversiÃ³n total: â‚¬' . number_format(collect($sources)->sum('construction_cost'), 2));
        $this->command->info('ğŸ“ Regiones: AndalucÃ­a, Cantabria, Castilla y LeÃ³n, CataluÃ±a');
        $this->command->info('ğŸŒ± CategorÃ­as: Renovables (4), No Renovables (1)');
        $this->command->info('ğŸ“Š Datos realistas: Capacidades, eficiencias y mÃ©tricas operativas');
    }
}
